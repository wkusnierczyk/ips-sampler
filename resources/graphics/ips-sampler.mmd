flowchart TD
    subgraph CLI Layer
    A[cli.py] -->|parses args| B[Configuration]
    end

    subgraph Library Layer
    C[IPSGenerator] -->|consumes| B
    C -->|loads| D[Data Loader]
    D -->|reads| E[ips_config.json]
    C -->|constructs| F[IPSBuilder]
    end

    subgraph Output
    F -->|builds| G[FHIR Bundle]
    G -->|saves to| H[Disk]
    end

    style A fill:#f9f,stroke:#333
    style C fill:#ccf,stroke:#333
    style E fill:#ffc,stroke:#333